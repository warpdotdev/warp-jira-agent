services:
  warp-jira-agent:
    build:
      context: .
      args:
        CHANNEL: ${CHANNEL:-dev}
        TARGETARCH: ${TARGETARCH:-amd64}
    command: ["poll"]
    init: true
    container_name: warp-jira-agent
    env_file:
      - .env
    restart: unless-stopped
    volumes:
      - repos_data:/app/repos
      - workspace_data:/app/workspaces
      - ./repos.yaml:/app/repos.yaml:ro

volumes:
  repos_data:
  workspace_data: